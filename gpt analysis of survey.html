<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Client Health Evaluation</title>
    <style>
        body {
            background-color: black;
            color: white;
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .file-input {
            margin-bottom: 20px;
        }
        .submit-button {
            margin-top: 20px;
        }
        .recommendations {
            margin-top: 20px;
        }
        .download-button {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Client Health Evaluation</h1>
        <input type="file" id="fileInput" class="file-input">
        <div class="submit-button">
            <button onclick="evaluateClientData()">Evaluate</button>
        </div>
        <div class="recommendations" id="recommendations">
            <!-- Recommendations will be displayed here -->
        </div>
        <div class="download-button" id="downloadButton">
            <!-- Download button will be displayed here -->
        </div>
    </div>

    <script>
        async function evaluateClientData() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            if (!file) {
                alert('Please upload a JSON file.');
                return;
            }

            const reader = new FileReader();
            reader.onload = async function(e) {
                const clientData = JSON.parse(e.target.result);

                const recommendations = await getRecommendations(clientData);

                const recommendationsDiv = document.getElementById('recommendations');
                recommendationsDiv.innerHTML = `
                    <h2>Recommendations</h2>
                    <pre>${recommendations}</pre>
                `;

                const downloadButtonDiv = document.getElementById('downloadButton');
                downloadButtonDiv.innerHTML = `
                    <button onclick="downloadRecommendations()">Download Recommendations</button>
                `;

                window.clientData = clientData;
                window.recommendations = recommendations;
            };
            reader.readAsText(file);
        }

        async function getRecommendations(clientData) {
            const response = await fetch('https://api.openai.com/v1/engines/gpt-4/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer YOUR_OPENAI_API_KEY`
                },
                body: JSON.stringify({
                    prompt: generatePrompt(clientData),
                    max_tokens: 1500,
                    n: 1,
                    stop: null,
                    temperature: 0.7
                })
            });

            const data = await response.json();
            return data.choices[0].text;
        }

        function generatePrompt(clientData) {
            return `
                The following is a health and wellness assessment based on the client's provided data:
                ${JSON.stringify(clientData, null, 2)}
                
                Please evaluate the data and provide detailed recommendations for improvement in areas where the client needs attention. Focus on improving longevity and overall well-being.
            `;
        }

        function downloadRecommendations() {
            const combinedData = {
                clientData: window.clientData,
                recommendations: window.recommendations
            };

            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(combinedData, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "client_recommendations.json");
            document.body.appendChild(downloadAnchorNode); // required for firefox
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
        }
    </script>
</body>
</html>
